<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Power Map Generator: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Power Map Generator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Power Map Generator Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>See <a class="el" href="classargs__t.html">args_t</a> for command line usage</p>
<p>The code in this folder is designed to generate semi-random heat maps for the hotspot benchmark from the rodinia benchmark suite by superimposing a bunch of 2D gaussians into the power map plane. It is possible to directly call the <a class="el" href="generate__power__map_8h.html#a482b25246cc7bb551c498270e3e9b4fb">generate_power_map</a> function from within hotspot.cu (external) and feed the generated power maps to the cuda kernel inside. Alternativly, the code in this folder may be compiled into a stand-alone utility which generates and dumps heat maps into either txt or png files.</p>
<p>Example: Integrating this code into the hotspot.cu code directly<br />
</p><ol type="1">
<li>Copy the following files into the directory containing hotspot.cu <a class="el" href="generate__power__map_8cpp.html">generate_power_map.cpp</a><br />
 <a class="el" href="generate__power__map_8h.html">generate_power_map.h</a><br />
 <a class="el" href="hotspot_8cpp.html">hotspot.cpp</a><br />
 <a class="el" href="hotspot_8h.html">hotspot.h</a><br />
 <a class="el" href="power__map__state_8cpp.html">power_map_state.cpp</a><br />
 <a class="el" href="power__map__state_8h.html">power_map_state.h</a><br />
</li>
<li>Include the power map generator code at the top of hotspot.cu with the other includes <div class="fragment"><div class="line"><span class="comment">// hotspot.cu</span></div><div class="line">...</div><div class="line">#include <span class="stringliteral">&quot;generate_power_map.h&quot;</span></div><div class="line">...</div></div><!-- fragment --></li>
<li>The randomly generated power maps are created by superimposing a bunch of random 2D gaussians onto the power map. Since we want the power map to only change slightly between each iteration, we want to keep most of the gaussians in the same positions and only expand/shink them slightly. Declaring a <a class="el" href="classpower__map__state__t.html">power_map_state_t</a> variable keeps track of all the hotspots on the power map and tracks each of their lifecycles so they can be changed smoothly over time. See <a class="el" href="classpower__map__state__t.html">power_map_state_t</a> and <a class="el" href="classhotspot__t.html" title="Class for storing the parameters for a gaussian shaped hotspot to be drawn onto a power map...">hotspot_t</a> for detailed documentation on how the power map is generated. <div class="fragment"><div class="line">...</div><div class="line"><span class="comment">// Construct state object (you add this).</span></div><div class="line"><span class="comment">// Feel free to tweak the parameters after &#39;Height&#39;.  See \ref</span></div><div class="line"><span class="comment">// hotspot_t</span></div><div class="line">power_map_state_t power_map_state</div><div class="line">(</div><div class="line">    col,                <span class="comment">// Width</span></div><div class="line">    row,                <span class="comment">// Height</span></div><div class="line">    1024,               <span class="comment">// Max hotspots</span></div><div class="line">    10.0f,              <span class="comment">// Min peak amplitude</span></div><div class="line">    50.0f,              <span class="comment">// Max peak amplitude</span></div><div class="line">    5.0f,               <span class="comment">// Min stdev</span></div><div class="line">    15.0f,              <span class="comment">// Max stddev</span></div><div class="line">    5.0f,               <span class="comment">// Min aging rate</span></div><div class="line">    20.0f               <span class="comment">// Max aging rate</span></div><div class="line">);</div><div class="line">...</div><div class="line"><span class="comment">// Main loop (already declared)</span></div><div class="line">for (<span class="keywordtype">int</span> t = 0; t &lt; total_iterations; t += num_iterations)</div><div class="line">{</div><div class="line">...</div></div><!-- fragment --></li>
<li>Add code to the main loop to update the power map each iteration and copy the new power map to the GPU. <div class="fragment"><div class="line">...</div><div class="line">unsigned linear_size = col * row;</div><div class="line"><span class="keywordtype">float</span>* host_power = <span class="keyword">new</span> <span class="keywordtype">float</span>[row * col];</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; total_iterations; t += num_iterations)</div><div class="line">{</div><div class="line">    </div><div class="line">    <span class="keywordtype">int</span> temp = src;</div><div class="line">    src = dst;</div><div class="line">    dst = temp;</div><div class="line">    </div><div class="line">    <a class="code" href="generate__power__map_8cpp.html#ab442a521c660a269846bf7c8eecc0cc6">generate_power_map</a>(&amp;power_map_state, host_power);</div><div class="line">    cudaMemcpy(MatrixPower, host_power, linear_size * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), cudaMemcpyHostToDevice);</div><div class="line">    </div><div class="line">    calculate_temp</div><div class="line">        &lt;&lt;&lt;dimGrid, dimBlock&gt;&gt;&gt;</div><div class="line">        (</div><div class="line">            MIN(num_iterations, total_iterations - t),</div><div class="line">            MatrixPower,</div><div class="line">            MatrixTemp[src],</div><div class="line">            MatrixTemp[dst],</div><div class="line">            col, <span class="comment">// width</span></div><div class="line">            row, <span class="comment">// height</span></div><div class="line">            borderCols,</div><div class="line">            borderRows,</div><div class="line">            Cap,</div><div class="line">            Rx,</div><div class="line">            Ry,</div><div class="line">            Rz,</div><div class="line">            step,</div><div class="line">            time_elapsed</div><div class="line">        );</div><div class="line">        </div><div class="line">    ...</div><div class="line">    </div><div class="line">}</div><div class="line"><span class="keyword">delete</span>[] host_power;</div></div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 21 2017 16:13:02 for Power Map Generator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
